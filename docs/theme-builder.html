<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theme Builder - Aural UI</title>

    <!-- Aural UI CSS -->
    <link rel="stylesheet" href="./aural-ui.css?v=11">

    <!-- Theme CSS -->
    <link rel="stylesheet" href="./dark.css" id="theme-link">

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        .theme-builder {
            display: grid;
            grid-template-columns: 350px 1fr;
            height: 100vh;
            gap: 0;
        }

        /* Sidebar */
        .builder-sidebar {
            background: var(--color-bg-secondary);
            border-right: 1px solid var(--color-border-subtle);
            overflow-y: auto;
            padding: var(--space-6);
        }

        .builder-sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .builder-sidebar::-webkit-scrollbar-thumb {
            background: var(--color-border-medium);
            border-radius: var(--radius-full);
        }

        .builder-header {
            margin-bottom: var(--space-6);
        }

        .builder-title {
            font-size: var(--text-2xl);
            font-weight: var(--font-bold);
            color: var(--color-text-primary);
            margin: 0 0 var(--space-2) 0;
        }

        .builder-subtitle {
            font-size: var(--text-sm);
            color: var(--color-text-secondary);
            margin: 0;
        }

        /* Controls */
        .control-group {
            margin-bottom: var(--space-6);
        }

        .control-label {
            display: block;
            font-size: var(--text-sm);
            font-weight: var(--font-semibold);
            color: var(--color-text-primary);
            margin-bottom: var(--space-3);
        }

        .color-input-wrapper {
            display: flex;
            gap: var(--space-3);
            align-items: center;
        }

        .color-input {
            width: 60px;
            height: 44px;
            border: 2px solid var(--color-border-medium);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: var(--transition-all-fast);
        }

        .color-input:hover {
            border-color: var(--color-primary);
        }

        .color-value {
            flex: 1;
            font-family: var(--font-mono);
            font-size: var(--text-sm);
            color: var(--color-text-secondary);
        }

        .preset-themes {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-3);
        }

        .preset-theme {
            padding: var(--space-3);
            background: var(--color-bg-tertiary);
            border: 2px solid transparent;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: var(--transition-all-fast);
            text-align: center;
        }

        .preset-theme:hover {
            border-color: var(--color-primary);
            background: var(--color-bg-hover);
        }

        .preset-theme.active {
            border-color: var(--color-primary);
            background: var(--color-primary);
            color: white;
        }

        .preset-theme-name {
            font-size: var(--text-xs);
            font-weight: var(--font-semibold);
            margin-top: var(--space-2);
        }

        .preset-colors {
            display: flex;
            gap: 4px;
            justify-content: center;
            margin-bottom: var(--space-2);
        }

        .preset-color {
            width: 20px;
            height: 20px;
            border-radius: var(--radius-sm);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Preview Area */
        .builder-preview {
            background: var(--color-bg-primary);
            overflow-y: auto;
            padding: var(--space-8);
        }

        .preview-section {
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border-subtle);
            border-radius: var(--radius-lg);
            padding: var(--space-6);
            margin-bottom: var(--space-6);
        }

        .preview-section-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--color-text-primary);
            margin: 0 0 var(--space-4) 0;
        }

        .component-preview {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-3);
            margin-bottom: var(--space-4);
        }

        /* Contrast Checker */
        .contrast-checker {
            background: var(--color-bg-tertiary);
            border: 1px solid var(--color-border-subtle);
            border-radius: var(--radius-md);
            padding: var(--space-4);
            margin-top: var(--space-4);
        }

        .contrast-result {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-2) 0;
            border-bottom: 1px solid var(--color-border-subtle);
        }

        .contrast-result:last-child {
            border-bottom: none;
        }

        .contrast-label {
            font-size: var(--text-sm);
            color: var(--color-text-secondary);
        }

        .contrast-value {
            font-size: var(--text-sm);
            font-weight: var(--font-semibold);
            font-family: var(--font-mono);
        }

        .contrast-pass {
            color: var(--color-success);
        }

        .contrast-fail {
            color: var(--color-error);
        }

        /* Export Section */
        .export-section {
            position: sticky;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--color-bg-secondary);
            border-top: 1px solid var(--color-border-subtle);
            padding: var(--space-4) var(--space-6);
        }

        .export-buttons {
            display: flex;
            gap: var(--space-3);
        }

        @media (max-width: 1024px) {
            .theme-builder {
                grid-template-columns: 1fr;
            }

            .builder-sidebar {
                border-right: none;
                border-bottom: 1px solid var(--color-border-subtle);
            }
        }
    </style>
</head>
<body>
    <div class="theme-builder">
        <!-- Sidebar Controls -->
        <div class="builder-sidebar">
            <div class="builder-header">
                <h1 class="builder-title">Theme Builder</h1>
                <p class="builder-subtitle">Create your custom Aural UI theme</p>
            </div>

            <!-- Preset Themes -->
            <div class="control-group">
                <label class="control-label">Base Theme</label>
                <div class="preset-themes">
                    <div class="preset-theme active" data-theme="dark" onclick="loadPreset('dark')">
                        <div class="preset-colors">
                            <div class="preset-color" style="background: #5ebd8f;"></div>
                            <div class="preset-color" style="background: #0f0f1a;"></div>
                            <div class="preset-color" style="background: #1a1a2e;"></div>
                        </div>
                        <div class="preset-theme-name">Dark</div>
                    </div>
                    <div class="preset-theme" data-theme="light" onclick="loadPreset('light')">
                        <div class="preset-colors">
                            <div class="preset-color" style="background: #10b981;"></div>
                            <div class="preset-color" style="background: #ffffff;"></div>
                            <div class="preset-color" style="background: #f9fafb;"></div>
                        </div>
                        <div class="preset-theme-name">Light</div>
                    </div>
                    <div class="preset-theme" data-theme="high-contrast" onclick="loadPreset('high-contrast')">
                        <div class="preset-colors">
                            <div class="preset-color" style="background: #0096ff;"></div>
                            <div class="preset-color" style="background: #000000;"></div>
                            <div class="preset-color" style="background: #ffffff;"></div>
                        </div>
                        <div class="preset-theme-name">High Contrast</div>
                    </div>
                    <div class="preset-theme" data-theme="colorblind" onclick="loadPreset('colorblind')">
                        <div class="preset-colors">
                            <div class="preset-color" style="background: #1a8cff;"></div>
                            <div class="preset-color" style="background: #ffa31a;"></div>
                            <div class="preset-color" style="background: #0f1419;"></div>
                        </div>
                        <div class="preset-theme-name">Colorblind</div>
                    </div>
                </div>
            </div>

            <!-- Primary Color -->
            <div class="control-group">
                <label class="control-label" for="primary-color">Primary Color</label>
                <div class="color-input-wrapper">
                    <input type="color" id="primary-color" class="color-input" value="#5ebd8f" onchange="updateColor('primary', this.value)">
                    <input type="text" id="primary-value" class="input color-value" value="#5ebd8f" onchange="updateColorFromText('primary', this.value)">
                </div>
            </div>

            <!-- Secondary Color -->
            <div class="control-group">
                <label class="control-label" for="secondary-color">Secondary Color</label>
                <div class="color-input-wrapper">
                    <input type="color" id="secondary-color" class="color-input" value="#06b6d4" onchange="updateColor('secondary', this.value)">
                    <input type="text" id="secondary-value" class="input color-value" value="#06b6d4" onchange="updateColorFromText('secondary', this.value)">
                </div>
            </div>

            <!-- Success Color -->
            <div class="control-group">
                <label class="control-label" for="success-color">Success Color</label>
                <div class="color-input-wrapper">
                    <input type="color" id="success-color" class="color-input" value="#22c55e" onchange="updateColor('success', this.value)">
                    <input type="text" id="success-value" class="input color-value" value="#22c55e" onchange="updateColorFromText('success', this.value)">
                </div>
            </div>

            <!-- Error Color -->
            <div class="control-group">
                <label class="control-label" for="error-color">Error Color</label>
                <div class="color-input-wrapper">
                    <input type="color" id="error-color" class="color-input" value="#ef4444" onchange="updateColor('error', this.value)">
                    <input type="text" id="error-value" class="input color-value" value="#ef4444" onchange="updateColorFromText('error', this.value)">
                </div>
            </div>

            <!-- Warning Color -->
            <div class="control-group">
                <label class="control-label" for="warning-color">Warning Color</label>
                <div class="color-input-wrapper">
                    <input type="color" id="warning-color" class="color-input" value="#f59e0b" onchange="updateColor('warning', this.value)">
                    <input type="text" id="warning-value" class="input color-value" value="#f59e0b" onchange="updateColorFromText('warning', this.value)">
                </div>
            </div>

            <!-- Contrast Checker -->
            <div class="control-group">
                <label class="control-label">Contrast Ratios</label>
                <div class="contrast-checker" id="contrast-results">
                    <div class="contrast-result">
                        <span class="contrast-label">Primary on Dark</span>
                        <span class="contrast-value" id="primary-contrast">7.2:1</span>
                    </div>
                    <div class="contrast-result">
                        <span class="contrast-label">WCAG AA</span>
                        <span class="contrast-value contrast-pass" id="wcag-aa">✓ Pass</span>
                    </div>
                    <div class="contrast-result">
                        <span class="contrast-label">WCAG AAA</span>
                        <span class="contrast-value contrast-pass" id="wcag-aaa">✓ Pass</span>
                    </div>
                </div>
            </div>

            <!-- Export Section -->
            <div class="export-section">
                <div class="export-buttons">
                    <button class="btn btn-primary" onclick="exportTheme()">
                        <i data-lucide="download"></i>
                        Export CSS
                    </button>
                    <button class="btn btn-secondary" onclick="copyTheme()">
                        <i data-lucide="copy"></i>
                        Copy
                    </button>
                </div>
            </div>
        </div>

        <!-- Preview Area -->
        <div class="builder-preview">
            <!-- Buttons Preview -->
            <div class="preview-section">
                <h2 class="preview-section-title">Buttons</h2>
                <div class="component-preview">
                    <button class="btn btn-primary">Primary</button>
                    <button class="btn btn-secondary">Secondary</button>
                    <button class="btn btn-danger">Danger</button>
                    <button class="btn btn-ghost">Ghost</button>
                </div>
                <div class="component-preview">
                    <button class="btn btn-primary btn-sm">Small</button>
                    <button class="btn btn-primary">Medium</button>
                    <button class="btn btn-primary btn-lg">Large</button>
                </div>
            </div>

            <!-- Inputs Preview -->
            <div class="preview-section">
                <h2 class="preview-section-title">Inputs</h2>
                <div class="form-group">
                    <label class="label">Email</label>
                    <input type="email" class="input" placeholder="Enter your email">
                    <p class="form-helper">We'll never share your email</p>
                </div>
                <div class="form-group">
                    <label class="label">Message</label>
                    <textarea class="input" rows="3" placeholder="Type your message"></textarea>
                </div>
            </div>

            <!-- Alerts Preview -->
            <div class="preview-section">
                <h2 class="preview-section-title">Alerts</h2>
                <div style="display: flex; flex-direction: column; gap: var(--space-3);">
                    <div class="alert alert-success">
                        <strong>Success!</strong> Your changes have been saved.
                    </div>
                    <div class="alert alert-error">
                        <strong>Error!</strong> Something went wrong.
                    </div>
                    <div class="alert alert-warning">
                        <strong>Warning!</strong> Please review your input.
                    </div>
                    <div class="alert alert-info">
                        <strong>Info!</strong> New update available.
                    </div>
                </div>
            </div>

            <!-- Cards Preview -->
            <div class="preview-section">
                <h2 class="preview-section-title">Cards</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--space-4);">
                    <div class="card">
                        <h3>Card Title</h3>
                        <p>This is a sample card with some content to preview the theme.</p>
                        <button class="btn btn-primary btn-sm">Learn More</button>
                    </div>
                    <div class="card">
                        <h3>Another Card</h3>
                        <p>Cards help organize content into distinct sections.</p>
                        <button class="btn btn-secondary btn-sm">View Details</button>
                    </div>
                </div>
            </div>

            <!-- Badges Preview -->
            <div class="preview-section">
                <h2 class="preview-section-title">Badges</h2>
                <div class="component-preview">
                    <span class="badge badge-primary">Primary</span>
                    <span class="badge badge-secondary">Secondary</span>
                    <span class="badge badge-success">Success</span>
                    <span class="badge badge-error">Error</span>
                    <span class="badge badge-warning">Warning</span>
                    <span class="badge badge-info">Info</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Aural UI JavaScript -->
    <script src="./aural-ui.js"></script>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // Theme presets
        const presets = {
            dark: {
                primary: '#5ebd8f',
                secondary: '#06b6d4',
                success: '#22c55e',
                error: '#ef4444',
                warning: '#f59e0b'
            },
            light: {
                primary: '#10b981',
                secondary: '#3b82f6',
                success: '#059669',
                error: '#dc2626',
                warning: '#d97706'
            },
            'high-contrast': {
                primary: '#0096ff',
                secondary: '#ffe600',
                success: '#00ff00',
                error: '#ff0000',
                warning: '#ffe600'
            },
            colorblind: {
                primary: '#1a8cff',
                secondary: '#ffa31a',
                success: '#1a8cff',
                error: '#ff8c1a',
                warning: '#ffde1a'
            }
        };

        // Load preset theme
        function loadPreset(themeName) {
            const preset = presets[themeName];
            if (!preset) return;

            // Update UI
            document.querySelectorAll('.preset-theme').forEach(el => {
                el.classList.toggle('active', el.dataset.theme === themeName);
            });

            // Update colors
            Object.entries(preset).forEach(([key, value]) => {
                updateColor(key, value);
                document.getElementById(`${key}-color`).value = value;
                document.getElementById(`${key}-value`).value = value;
            });

            // Load theme CSS
            const themeLink = document.getElementById('theme-link');
            themeLink.href = themeName === 'dark' ? './dark.css' :
                            themeName === 'light' ? './light.css' :
                            themeName === 'high-contrast' ? './high-contrast.css' :
                            './colorblind-friendly.css';
        }

        // Update color from picker
        function updateColor(type, value) {
            document.documentElement.style.setProperty(`--color-${type}`, value);
            document.getElementById(`${type}-value`).value = value;
            updateContrastChecker();
        }

        // Update color from text input
        function updateColorFromText(type, value) {
            if (/^#[0-9A-F]{6}$/i.test(value)) {
                document.documentElement.style.setProperty(`--color-${type}`, value);
                document.getElementById(`${type}-color`).value = value;
                updateContrastChecker();
            }
        }

        // Calculate contrast ratio
        function getContrastRatio(color1, color2) {
            const getLuminance = (color) => {
                const rgb = parseInt(color.slice(1), 16);
                const r = ((rgb >> 16) & 0xff) / 255;
                const g = ((rgb >> 8) & 0xff) / 255;
                const b = (rgb & 0xff) / 255;

                const [rs, gs, bs] = [r, g, b].map(c =>
                    c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4)
                );

                return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs;
            };

            const l1 = getLuminance(color1);
            const l2 = getLuminance(color2);
            const lighter = Math.max(l1, l2);
            const darker = Math.min(l1, l2);

            return (lighter + 0.05) / (darker + 0.05);
        }

        // Update contrast checker
        function updateContrastChecker() {
            const primaryColor = document.getElementById('primary-value').value;
            const bgColor = '#0f0f1a'; // Dark background

            const ratio = getContrastRatio(primaryColor, bgColor);
            const ratioFixed = ratio.toFixed(1);

            document.getElementById('primary-contrast').textContent = `${ratioFixed}:1`;

            const passAA = ratio >= 4.5;
            const passAAA = ratio >= 7;

            const aaEl = document.getElementById('wcag-aa');
            aaEl.textContent = passAA ? '✓ Pass' : '✕ Fail';
            aaEl.className = passAA ? 'contrast-value contrast-pass' : 'contrast-value contrast-fail';

            const aaaEl = document.getElementById('wcag-aaa');
            aaaEl.textContent = passAAA ? '✓ Pass' : '✕ Fail';
            aaaEl.className = passAAA ? 'contrast-value contrast-pass' : 'contrast-value contrast-fail';
        }

        // Export theme CSS
        function exportTheme() {
            const primary = document.getElementById('primary-value').value;
            const secondary = document.getElementById('secondary-value').value;
            const success = document.getElementById('success-value').value;
            const error = document.getElementById('error-value').value;
            const warning = document.getElementById('warning-value').value;

            const css = `/**
 * Custom Aural UI Theme
 * Generated by Theme Builder
 */

:root {
    --color-primary: ${primary};
    --color-secondary: ${secondary};
    --color-success: ${success};
    --color-error: ${error};
    --color-warning: ${warning};
}
`;

            // Download file
            const blob = new Blob([css], { type: 'text/css' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'custom-theme.css';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Copy theme CSS
        function copyTheme() {
            const primary = document.getElementById('primary-value').value;
            const secondary = document.getElementById('secondary-value').value;
            const success = document.getElementById('success-value').value;
            const error = document.getElementById('error-value').value;
            const warning = document.getElementById('warning-value').value;

            const css = `:root {
    --color-primary: ${primary};
    --color-secondary: ${secondary};
    --color-success: ${success};
    --color-error: ${error};
    --color-warning: ${warning};
}`;

            navigator.clipboard.writeText(css).then(() => {
                alert('Theme CSS copied to clipboard!');
            });
        }

        // Initialize
        updateContrastChecker();
    </script>

    <!-- Unified Theme Sync -->
    <script>
    (function() {
        const savedTheme = localStorage.getItem('theme') || 'dark';
        const themeLink = document.getElementById('theme-link');

        if (themeLink) {
            const isInComponents = window.location.pathname.includes('/components/');
            const relativePath = isInComponents ? '../' : './';
            const themePath = savedTheme === 'dark' ? relativePath + 'dark.css' : relativePath + 'light.css';

            themeLink.href = themePath;
        }

        window.addEventListener('DOMContentLoaded', function() {
            try {
                if (window.self !== window.top) {
                    const themeToggle = document.querySelector('.theme-toggle');
                    if (themeToggle) {
                        themeToggle.style.display = 'none';
                    }
                }
            } catch (e) {}
        });
    })();
    </script>
</body>
</html>
